j<-1
FIL<-dplyr::filter(NEWDF2,NEWDF2$Country1==UNF[[j]])
View(FIL)
FIL<-dplyr::filter(NEWDF2,NEWDF2$Country1==UNF[[j]])
FIL2<-FIL[FIL$Country2%in%FIL$CountryBROKER,]
View(FIL)
UNF<-igraph::V(gs)$name
FIL<-dplyr::filter(NEWDF2,NEWDF2$Country1==UNF[[j]])
FIL2<-FIL[FIL$Country2%in%FIL$CountryBROKER,]
View(FIL)
NEWDF2<-as.data.frame(DATA2,stringsAsFactors=FALSE)
UNF<-igraph::V(gs)$name
WH_LIST<-list()
FIL<-dplyr::filter(NEWDF2,NEWDF2$Country1==UNF[[j]])
FIL2<-FIL[FIL$Country2%in%FIL$CountryBROKER,]
View(FIL2)
View(FIL)
UNF
j<-8
FIL<-dplyr::filter(NEWDF2,NEWDF2$Country1==UNF[[j]])
View(FIL)
WH_C_LIST<-list()
k<-1
NEWDF2<-as.data.frame(DATA2,stringsAsFactors=FALSE)
UNF<-igraph::V(gs)$name
WH_LIST<-list()
for (j in 1:length(UNF)){
FIL<-dplyr::filter(NEWDF2,NEWDF2$Country1==UNF[[j]])
FIL2<-FIL[FIL$Country2%in%FIL$CountryBROKER,]
#FIL2<-dplyr::filter(FIL,FIL$Firm2BROKER==NEWDF2$Firm3[[j]])
#FIL3<-dplyr::filter(FIL,NEWDF2$Firm1==NEWDF2$Firm1[[j]])
#NEWDF3<-anti_join(NEWDF2,FIL2,by="NoEdges")
WH<-which(NEWDF2$Country1 %in% FIL2$Country1 &
NEWDF2$CountryBROKER %in% FIL2$CountryBROKER &
NEWDF2$Country2 %in% FIL2$Country2)
WH_LIST[[j]]<-WH
}
WH_B<-unlist(WH_LIST)
WH_B<-unique(WH_B)
NEWDF2<-NEWDF2[-WH_B,]
FIL<-dplyr::filter(NEWDF2,NEWDF2$Country2==UNF[[k]])
FIL2<-FIL[FIL$Country1%in%FIL$CountryBROKER,]
View(FIL)
k<-2
FIL<-dplyr::filter(NEWDF2,NEWDF2$Country2==UNF[[k]])
FIL2<-FIL[FIL$Country1%in%FIL$CountryBROKER,]
UNF
k<-4
FIL<-dplyr::filter(NEWDF2,NEWDF2$Country2==UNF[[k]])
FIL2<-FIL[FIL$Country1%in%FIL$CountryBROKER,]
WH_C_LIST<-list()
for (k in 1:length(UNF)){
FIL<-dplyr::filter(NEWDF2,NEWDF2$Country2==UNF[[k]])
FIL2<-FIL[FIL$Country1%in%FIL$CountryBROKER,]
#FIL2<-dplyr::filter(FIL,FIL$Firm2BROKER==NEWDF2$Firm3[[j]])
#FIL3<-dplyr::filter(FIL,NEWDF2$Firm1==NEWDF2$Firm1[[j]])
#NEWDF3<-anti_join(NEWDF2,FIL2,by="NoEdges")
WHC<-which(NEWDF2$Country1 %in% FIL2$Country1 &
NEWDF2$CountryBROKER %in% FIL2$CountryBROKER &
NEWDF2$Country2 %in% FIL2$Country2)
WH_C_LIST[[j]]<-WHC
}
WH_C<-unlist(WH_C_LIST)
WH_C<-unique(WH_C)
FIL<-dplyr::filter(NEWDF2,NEWDF2$Country2==UNF[[k]])
View(FIL)
View(NEWDF2)
UNF
k<-14
FIL<-dplyr::filter(NEWDF2,NEWDF2$Country2==UNF[[k]])
FIL2<-FIL[FIL$Country1%in%FIL$CountryBROKER,]
View(FIL)
FIL<-dplyr::filter(NEWDF2,NEWDF2$CountryBROKER==UNF[[k]])
View(FIL)
FIL2<-FIL[FIL$Country2%in%FIL$Country2,]
FIL2<-FIL[FIL$Country1%in%FIL$Country2,]
View(FIL2)
#FIL2<-dplyr::filter(FIL,FIL$Firm2BROKER==NEWDF2$Firm3[[j]])
#FIL3<-dplyr::filter(FIL,NEWDF2$Firm1==NEWDF2$Firm1[[j]])
#NEWDF3<-anti_join(NEWDF2,FIL2,by="NoEdges")
WHC<-which(NEWDF2$Country1 %in% FIL2$Country1 &
NEWDF2$CountryBROKER %in% FIL2$CountryBROKER &
NEWDF2$Country2 %in% FIL2$Country2)
FIL<-dplyr::filter(NEWDF2,NEWDF2$CountryBROKER==UNF[[k]])
NEWDF2<-as.data.frame(DATA2,stringsAsFactors=FALSE)
UNF<-igraph::V(gs)$name
WH_LIST<-list()
for (j in 1:length(UNF)){
FIL<-dplyr::filter(NEWDF2,NEWDF2$Country1==UNF[[j]])
FIL2<-FIL[FIL$Country2%in%FIL$CountryBROKER,]
#FIL2<-dplyr::filter(FIL,FIL$Firm2BROKER==NEWDF2$Firm3[[j]])
#FIL3<-dplyr::filter(FIL,NEWDF2$Firm1==NEWDF2$Firm1[[j]])
#NEWDF3<-anti_join(NEWDF2,FIL2,by="NoEdges")
WH<-which(NEWDF2$Country1 %in% FIL2$Country1 &
NEWDF2$CountryBROKER %in% FIL2$CountryBROKER &
NEWDF2$Country2 %in% FIL2$Country2)
WH_LIST[[j]]<-WH
}
WH_B<-unlist(WH_LIST)
WH_B<-unique(WH_B)
NEWDF2<-NEWDF2[-WH_B,]
View(NEWDF2)
NEWDF2<-dplyr::filter(NEWDF2,NoEdges<5)
View(NEWDF2)
NEWDF2<-as.data.frame(DATA2,stringsAsFactors=FALSE)
j<-1
H<-NEWDF2[j,]
HC<-gs[H$Country1,H$Country2]
(gs[H$Country1,H$Country2])
H$Country1
H$Country2
HC<-(gs[H$Country1,"MEX"])
HCT<-HC>0
NEWDF2<-as.data.frame(DATA2,stringsAsFactors=FALSE)
CONNECT_LIST<-list()
for (j in 1:length(NEWDF2$Country1)){
H<-NEWDF2[j,]
HC<-(gs[H$Country1,H$Country2])
HCT<-HC>0
CONNECT_LIST[[j]]<-HCT
}
NEWDF2$CHECK<-unlist(HCT)
View(NEWDF2)
i<-1
j<-1
H<-NEWDF2[j,]
View(H)
HC<-(gs[H$Country1,H$Country2])
HCT<-HC>0
HCT
for (j in 1:length(NEWDF2$Country1)){
H<-NEWDF2[j,]
HC<-(gs[H$Country1,H$Country2])
HCT<-HC>0
CONNECT_LIST[[j]]<-HCT
}
NEWDF2$CHECK<-unlist(CONNECT_LIST)
View(NEWDF2)
NEWDF3<-dplyr::filter(NEWDF2,CHECK!=TRUE)
NEWDF3$CHECK<-NULL
View(NEWDF3)
CONNECT_LIST_2<-list()
for (k in 1:length(NEWDF3$Country1)){
H<-NEWDF3[k,]
HC<-(gs[H$Country2,H$Country1])
HCT<-HC>0
CONNECT_LIST_2[[k]]<-HCT
}
NEWDF3$CHECK<-unlist(CONNECT_LIST_2)
View(NEWDF3)
NEWDF4<-dplyr::filter(NEWDF3,CHECK!=TRUE)
NEWDF4$CHECK<-NULL
View(NEWDF4)
NEWDF2<-dplyr::filter(NEWDF3,CHECK!=TRUE)
NEWDF2$CHECK<-NULL
NEWDF2$REGION1<-NEWDF2$Country1
NEWDF2$REGION_BROKER<-NEWDF2$CountryBROKER
NEWDF2$REGION2<-NEWDF2$Country2
GN1<-c("name",attrname)
GROUP_ID<-Vert[,GN1]
colnames(GROUP_ID)<-c("name","group")
NEWDF2$REGION1<-GROUP_ID$group[match(NEWDF2$Country1,
GROUP_ID$name)]
NEWDF2$REGION_BROKER<-GROUP_ID$group[match(NEWDF2$CountryBROKER,
GROUP_ID$name)]
NEWDF2$REGION2<-GROUP_ID$group[match(NEWDF2$Country2,
GROUP_ID$name)]
View(NEWDF2)
COOR_DF<-dplyr::filter(NEWDF2,
NEWDF2$REGION11==NEWDF2$REGION_BROKER&
NEWDF2$REGION_BROKER==NEWDF2$REGION2)
COOR_DF<-dplyr::filter(NEWDF2,
NEWDF2$REGION1==NEWDF2$REGION_BROKER&
NEWDF2$REGION_BROKER==NEWDF2$REGION2)
View(COOR_DF)
View(COOR_DF)
RegionalBrokerage(gs,"TEST")
BROKERAGE_PATH_LIST<-list(COOR_DF,REP_DF,ITIN_DF,LIA_DF)
BROKERAGE_PATH_LIST<-list(Coordinator=COOR_DF,
Representative=REP_DF,
Gatekeeper=GATE_DF,
Consultant=ITIN_DF,
Liaison=LIA_DF)
COOR_DF<-dplyr::filter(NEWDF2,
NEWDF2$REGION1==NEWDF2$REGION_BROKER&
NEWDF2$REGION_BROKER==NEWDF2$REGION2)
GATE_DF<-dplyr::filter(NEWDF2,NEWDF2$REGION1!=NEWDF2$REGION_BROKER&
NEWDF2$REGION_BROKER==NEWDF2$REGION2)
REP_DF<-dplyr::filter(NEWDF2,NEWDF2$REGION1==NEWDF2$REGION_BROKER&
NEWDF2$REGION_BROKER!=NEWDF2$REGION2)
ITIN_DF<-dplyr::filter(NEWDF2,NEWDF2$REGION1==NEWDF2$REGION2&
NEWDF2$REGION1!=NEWDF2$REGION_BROKER)
LIA_DF<-dplyr::filter(NEWDF2,NEWDF2$REGION1!=NEWDF2$REGION_BROKER&
NEWDF2$REGION_BROKER!=NEWDF2$REGION2&
NEWDF2$REGION1!=NEWDF2$REGION2)
BROKERAGE_PATH_LIST<-list(Coordinator=COOR_DF,
Representative=REP_DF,
Gatekeeper=GATE_DF,
Consultant=ITIN_DF,
Liaison=LIA_DF)
REP_RES_G3<-spread(REP_DF)
library(tidyverse)
REP_RES_G3<-spread(REP_DF)
REP_RES_G3<-spread(REP_DF,REGION_BROKER)
colnames(COOR_DF)
COOR_IND<-dplyr::select(COOR_DF,CountryBROKER,REGION_BROKER)
COOR_IND<-add_count(COOR_IND)
View(COOR_IND)
COOR_IND<-dplyr::select(COOR_DF,CountryBROKER,REGION_BROKER)
COOR_IND<-add_tally(COOR_IND)
View(COOR_IND)
??tally
COOR_IND<-tally(COOR_IND)
View(COOR_IND)
COOR_IND<-dplyr::select(COOR_DF,CountryBROKER,REGION_BROKER)
COOR_IND<-add_tally(COOR_IND,CountryBROKER)
COOR_IND<-tally(COOR_IND,CountryBROKER)
COOR_IND<-dplyr::select(COOR_DF,CountryBROKER,REGION_BROKER)%>%
group_by(CountryBROKER)%>%
add_tally()
View(COOR_IND)
COOR_IND<-dplyr::select(COOR_DF,CountryBROKER,REGION_BROKER)%>%
group_by(CountryBROKER)%>%
add_tally()%>%unique()
View(COOR_IND)
COOR_IND<-dplyr::group_by(dplyr::select(COOR_DF,CountryBROKER),CountryBROKER)
COOR_IND<-unique(add_tally(COOR_IND))
View(COOR_IND)
head(GN)
head(GC)
head(GROUP_ID)
COOR_IND<-dplyr::group_by(dplyr::select(COOR_DF,CountryBROKER),CountryBROKER)
COOR_IND<-unique(add_tally(COOR_IND))
colnames(COOR_IND)<-c("name","Coordinator")
REP_IND<-dplyr::group_by(dplyr::select(REP_DF,CountryBROKER),CountryBROKER)
REP_IND<-unique(add_tally(REP_IND))
colnames(REP_IND)<-c("name","Representative")
GATE_IND<-dplyr::group_by(dplyr::select(GATE_DF,CountryBROKER),CountryBROKER)
GATE_IND<-unique(add_tally(GATE_IND))
colnames(GATE_IND)<-c("name","Gatekeeper")
ITIN_IND<-dplyr::group_by(dplyr::select(ITIN_DF,CountryBROKER),CountryBROKER)
ITIN_IND<-unique(add_tally(ITIN_IND))
colnames(ITIN_IND)<-c("name","Consultant")
LIA_IND<-dplyr::group_by(dplyr::select(LIA_DF,CountryBROKER),CountryBROKER)
LIA_IND<-unique(add_tally(LIA_IND))
colnames(LIA_IND)<-c("name","Liaison")
MERGE1<-merge(GROUP_ID,COOR_IND,by.all="name",all.x=TRUE)
View(MERGE1)
MERGE2<-merge(MERGE1,REP_IND,by.all="name",all.x=TRUE)
View(MERGE2)
MERGE1<-merge(GROUP_ID,COOR_IND,by.all="name",all.x=TRUE)
MERGE2<-merge(MERGE1,REP_IND,by.all="name",all.x=TRUE)
MERGE3<-merge(MERGE2,GATE_IND,by.all="name",all.x=TRUE)
MERGE4<-merge(MERGE3,ITIN_IND,by.all="name",all.x=TRUE)
TOTAL_DF<-merge(MERGE4,LIA_IND,by.all="name",all.x=TRUE)
TOTAL_DF[is.na(TOTAL_DF)]<-0
View(TOTAL_DF)
TOTAL_DF$Total<-rowSums(TOTAL_DF)
TOTAL_DF$Total<-rowSums(TOTAL_DF[,3:7])
View(TOTAL_DF)
View(TOTAL_DF)
br <- matrix(.C("brokerage_R", as.double(g), as.integer(N),
as.integer(m), as.integer(icl), brok = as.double(br),
PACKAGE = "sna", NAOK = TRUE)$brok, N, 5)
View(br)
br <- cbind(br, apply(br, 1, sum))
gbr <- apply(br, 2, sum)
gbr
head(br)
colnames(TOTAL_DF)
br<-select(TOTAL_DF,Coordinator,Consultant,Representative,Gatekeeper,Liaison)
br<-as.matrix(br)
br<-select(TOTAL_DF,Coordinator,Consultant,Representative,Gatekeeper,Liaison,Total)
br<-as.matrix(br)
N<-vcount(gs)
N<-vcount(gs)
m<-ecount(gs)
cl<-vertex_attr(gs,attrname)
classes<-unique(cl)
icl<-match(cl,classes)
br<-select(TOTAL_DF,Coordinator,Consultant,
Representative,Gatekeeper,Liaison,Total)
br<-as.matrix(br)
gbr<-apply(br,2,sum)
classes
d<-m/(N*(N-1))
clid<-unique(cl)         #Count the class memberships
n<-vector()
for(i in clid)
n<-c(n,sum(cl==i))
n<-as.double(n)          #This shouldn't be needed, but R will generate
N<-as.double(N)          #integer overflows unless we coerce to double!
ebr<-matrix(0,length(clid),6)
vbr<-matrix(0,length(clid),6)
for(i in 1:length(clid)){  #Compute moments by broker's class
#Type 1: Within-group (wI)
ebr[i,1]<-d^2*(1-d)*(n[i]-1)*(n[i]-2)
vbr[i,1]<-ebr[i,1]*(1-d^2*(1-d))+2*(n[i]-1)*(n[i]-2)*(n[i]-3)*d^3*(1-d)^3
#Type 2: Itinerant (WO)
ebr[i,2]<-d^2*(1-d)*sum(n[-i]*(n[-i]-1))
vbr[i,2]<-ebr[i,2]*(1-d^2*(1-d))+ 2*sum(n[-i]*(n[-i]-1)*(n[-i]-2))*d^3*(1-d)^3
#Type 3: Representative (bIO)
ebr[i,3]<-d^2*(1-d)*(N-n[i])*(n[i]-1)
vbr[i,3]<-ebr[i,3]*(1-d^2*(1-d))+ 2*((n[i]-1)*choose(N-n[i],2)+(N-n[i])*choose(n[i]-1,2))*d^3*(1-d)^3
#Type 4: Gatekeeping (bOI)
ebr[i,4]<-ebr[i,3]
vbr[i,4]<-vbr[i,3]
#Type 5: Liason (bO)
ebr[i,5]<-d^2*(1-d)*(sum((n[-i])%o%(n[-i]))-sum(n[-i]^2))
vbr[i,5]<-ebr[i,5]*(1-d^2*(1-d))+ 4*sum(n[-i]*choose(N-n[-i]-n[i],2)*d^3*(1-d)^3)
#Total
ebr[i,6]<-d^2*(1-d)*(N-1)*(N-2)
vbr[i,6]<-ebr[i,6]*(1-d^2*(1-d))+2*(N-1)*(N-2)*(N-3)*d^3*(1-d)^3
}
br.exp<-vector()
br.sd<-vector()
for(i in 1:N){
temp<-match(cl[i],clid)
br.exp<-rbind(br.exp,ebr[temp,])
br.sd<-rbind(br.sd,sqrt(vbr[temp,]))
}
br.z<-(br-br.exp)/br.sd
egbr<-vector()                     #Global expections/variances
vgbr<-vector()
#Type 1: Within-group (wI)
egbr[1]<-d^2*(1-d)*sum(n*(n-1)*(n-2))
vgbr[1]<-egbr[1]*(1-d^2*(1-d))+
sum(n*(n-1)*(n-2)*(((4*n-10)*d^3*(1-d)^3)-(4*(n-3)*d^4*(1-d)^2)+
((n-3)*d^5*(1-d))))
#Type 2: Itinerant (WO)
egbr[2]<-d^2*(1-d)*sum(n*(N-n)*(n-1))
vgbr[2]<-egbr[2]*(1-d^2*(1-d))+
(sum(outer(n,n,function(x,y){
x*y*(x-1)*(((2*x+2*y-6)*d^3*(1-d)^3)+
((N-x-1)*d^5*(1-d)))}
)) -
sum(n*n*(n-1)*(((4*n-6)*d^3*(1-d)^3)+((N-n-1)*d^5*(1-d)))))
#Type 3: Representative (bIO)
egbr[3]<-d^2*(1-d)*sum(n*(N-n)*(n-1))
vgbr[3]<-egbr[3]*(1-d^2*(1-d))+
sum(n*(N-n)*(n-1)*(((N-3)*d^3*(1-d)^3)+((n-2)*d^5*(1-d))))
#Type 4: Gatekeeping (bOI)
egbr[4]<-egbr[3]
vgbr[4]<-vgbr[3]
#Type 5: Liason (bO)
egbr[5]<- d^2*(1-d)*(sum(outer(n,n,function(x,y){
x*y*(N-x-y)}
))-sum(n*n*(N-2*n)))
vgbr[5]<-egbr[5]*(1-d^2*(1-d))
for(i in 1:length(n))
for(j in 1:length(n))
for(k in 1:length(n))
if((i!=j)&&(j!=k)&&(i!=k))
vgbr[5]<-vgbr[5] + n[i]*n[j]*n[k] * ((4*(N-n[j])-2*(n[i]+n[k]+1))*d^3*(1-d)^3-(4*(N-n[k])-2*(n[i]+n[j]+1))*d^4*(1-d)^2+(N-(n[i]+n[k]+1))*d^5*(1-d))
#Total
egbr[6]<-d^2*(1-d)*N*(N-1)*(N-2)
vgbr[6]<-egbr[6]*(1-d^2*(1-d))+ N*(N-1)*(N-2)*
(((4*N-10)*d^3*(1-d)^3)-(4*(N-3)*d^4*(1-d)^2)+((N-3)*d^5*(1-d)))
#Return the results
br.nam<-c("w_I",#coordinator
"w_O",#Consultant
"b_IO",#Representative
"b_OI",#Gatekeeper
"b_O", #Liaison
"t")
colnames(br)<-br.nam
colnames(br)<-br.nam
colnames(br.exp)<-br.nam
colnames(br.sd)<-br.nam
colnames(br.z)<-br.nam
names(gbr)<-br.nam
names(egbr)<-br.nam
names(vgbr)<-br.nam
colnames(ebr)<-br.nam
rownames(ebr)<-clid
colnames(vbr)<-br.nam
rownames(vbr)<-clid
out<-list(raw.nli=br,exp.nli=br.exp,sd.nli=br.sd,z.nli=br.z,raw.gli=gbr, exp.gli=egbr,sd.gli=sqrt(vgbr),z.gli=(gbr-egbr)/sqrt(vgbr),exp.grp=ebr, sd.grp=sqrt(vbr),cl=cl,clid=clid,n=n,N=N)
View(out)
vertex_attr(gs,"name")
class(out)<-"brokerage"
out
cl
clid
n
N
sum(n)
class(out)
rep(LETTERS[1:5],25)
rep(LETTERS[1:5],15)
library(ITNr)
data("ELEnet16")
gs<-ELEnet16
attrname<-"regionNAME"
MM<-mixing_matrix_igraph(gs,
attrname)
source("R/mixing_matrix_igraph_function.R")
MM<-mixing_matrix_igraph(gs,
attrname)
source("R/mixing_matrix_igraph_function.R")
source("R/mixing_matrix_igraph_function.R")
MM<-mixing_matrix_igraph(gs,
attrname)
source("R/mixing_matrix_igraph_function.R")
MM<-mixing_matrix_igraph(gs,
attrname)
#(External-Internal)/External+Internal
MM1<-MM
diag(MM1)<-0
GRAPH_INTERNAL<-sum(diag(MM))
GRAPH_EXTERNAL<-sum(rowSums(MM1))
graph_EI<-(GRAPH_EXTERNAL - GRAPH_INTERNAL)/(GRAPH_EXTERNAL + GRAPH_INTERNAL)
num_groups<-dim(MM)[1]
group_name<-colnames(MM)
INTERNAL_LIST<-diag(MM)
RS<-rowSums(MM1)
CS<-colSums(MM1)
GROUP_DF_list<-list()
for (i in 1:num_groups){
name<-group_name[i]
INTER<-INTERNAL_LIST[i]
EXTER<-RS[i]+CS[i]
EIG<-(EXTER-INTER)/(EXTER+INTER)
GROUP_DF<-data.frame(group=name,
external.ties=EXTER,
internal.ties=INTER,
group.ei=EIG)
GROUP_DF_list[[i]]<-GROUP_DF
}
group_EI<-suppressWarnings(map_df(GROUP_DF_list,data.frame))
group_EI<-suppressWarnings(purrr::map_df(GROUP_DF_list,data.frame))
group_EI<-round_df(group_EI,4)
View(group_EI)
data("ELEnet16")
gs<-ELEnet16
attrname<-"regionNAME"
FULL_CENT<-data.frame(name=igraph::V(gs)$name,
out.degree=igraph::degree(gs,mode = "out"),
in.degree=igraph::degree(gs,mode = "in"),
total.degree=igraph::degree(gs,mode = "total"))
GROUP<-igraph::get.vertex.attribute(gs,attrname)
GROUP<-unique(GROUP)
num_group<-length(GROUP)
GROUP_MEM<-igraph::get.data.frame(gs,what="vertices")
H<-c("name",attrname)
GROUP_MEM<-GROUP_MEM[,H]
colnames(GROUP_MEM)<-c("name","group")
GROUP_CENT_LIST<-list()
for (i in 1:num_group){
G<-GROUP[[i]]
GM<-dplyr::filter(GROUP_MEM,group==G)
SUB<-igraph::induced_subgraph(gs,GM$name)
GC<-data.frame(name=igraph::V(SUB)$name,
group.out.degree=igraph::degree(SUB,mode = "out"),
group.in.degree=igraph::degree(SUB,mode = "in"),
group.total.degree=igraph::degree(SUB,mode = "total"),
group=rep(G,vcount(SUB)))
GROUP_CENT_LIST[[i]]<-GC
}
GROUP_CENT_LIST<-list()
for (i in 1:num_group){
G<-GROUP[[i]]
GM<-dplyr::filter(GROUP_MEM,group==G)
SUB<-igraph::induced_subgraph(gs,GM$name)
GC<-data.frame(name=igraph::V(SUB)$name,
group.out.degree=igraph::degree(SUB,mode = "out"),
group.in.degree=igraph::degree(SUB,mode = "in"),
group.total.degree=igraph::degree(SUB,mode = "total"),
group=rep(G,igraph::vcount(SUB)))
GROUP_CENT_LIST[[i]]<-GC
}
GROUP_CENT_DF<-suppressWarnings(purrr::map_df(GROUP_CENT_LIST,data.frame))
FULL_DF<-merge(FULL_CENT,GROUP_CENT_DF,by="name")
FULL_DF$Internal<-FULL_DF$group.total.degree
FULL_DF$External<-FULL_DF$total.degree-FULL_DF$group.total.degree
FULL_DF$EI<-(FULL_DF$External-FULL_DF$Internal)/FULL_DF$total.degree
View(FULL_DF)
MM<-mixing_matrix_igraph(gs,
attrname)
source("R/mixing_matrix_igraph_function.R")
MM<-mixing_matrix_igraph(gs,
attrname)
#(External-Internal)/External+Internal
MM1<-MM
diag(MM1)<-0
INT<-diag(MM)
#(External-Internal)/External+Internal
MM1<-MM
diag(MM1)<-0
EXT<-rowSums(MM1)
denominator<-EXT+INT
numerator<-EXT-INT
EI_NET<-numerator/denominator
EI_NET<-round(EI_NET,4)
INT<-sum(diag(MM))
#(External-Internal)/External+Internal
MM1<-MM
diag(MM1)<-0
EXT<-rowSums(MM1)
denominator<-EXT+INT
numerator<-EXT-INT
EI_NET<-numerator/denominator
EXT<-rowSums(MM1)
EXT<-sum(rowSums(MM1))
denominator<-EXT+INT
numerator<-EXT-INT
EI_NET<-numerator/denominator
EI_NET<-round(EI_NET,4)
library(ITNr)
??add_tally
library(ITNr)
library(ITNr)
